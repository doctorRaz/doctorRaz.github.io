---
title: Кладовка
description: Вытащенное с убитого блога, со временем растащится по отдельным статьям
author: doctorraz
date: 2022-08-13 11:33:00 +0300
categories: [nanoCAD, others]
tags: [nanocad, others]
pin: false
hidden: true
---

> не спеша привожу в порядок
{: .prompt-danger }

<!--
## для памяти

SORT BY 
doctorraz
drztools
 Утилиты для работы с блоками
By doctorraz, March 9


Автоматизация
Благодаря @Lidia.Antipina BGTOOLS почти полностью заработал в nanoCAD

Команд реально много, все не упомнишь, поэтому собрал на скорую руку менюшку (затолкал в нее все команды, некоторые работают не во всех нановерсиях)

подробное описание команд можно посмотреть в конце файла bgtools 3.11a_Nc_22.lsp ( @Lidia.Antipina достаточно подробно все расписала)

 

image.png.8c98f0680ed6b3349f999bbcf44d0cd8.png

 

Собрал панельку из четырех команд (муторно им иконки подбирать)))

image.png.dc6730b33ca7e68be8e0a6583cb39479.png

Ну и заодно пристегнул свою утилиту по нормализации блоков (старые куски кода собрал в кучу, когда BGTOOLS еще в нано не работала)

image.png.f66d879ace95a93a5b5b95cc7bda9069.png

кое в чем повторяет функционал BGTOOLS

из уникального:

умеет топить маскировки в блоках 
умеет синхронизировать атрибуты блоков не меняя их положение
------------------

Как этим добром  пользоваться:

Распаковать архив в доступное место
Добавить в автозагрузку файл BlockStandard.package
Перезагрузить нанокад, появится меню и две новых панельки
==========================

Естественно я все программы на всех возможных конфигурациях не тестировал, поэтому используем как есть, сохраняемся делаем копии, в общем обычная наноработа.

Отзывы, пожелания, критику в комментарии

 

 

BlockStandardNC_for_nanoCAD.zip

block
Read more... 
    
 0 comments 11,830 views
doctorraz
печать
 Публикация из nanoCAD СПДС (PlotSPDS)
By doctorraz, October 20, 2022


Автоматизация
Автоматическая печать из nanoCAD (только форматы СПДС)

Спойлер
Работает с nanoCAD22,23+СПДС или Механика

с nano20 работает (upd отдельная сборка)

с  nano21 не тестировал

 

Спойлер
Скачать архивчик (в аттаче)

Если установлена предыдущая версия PublishNC AnyCpu - надо удалить его из автозагрузки

Распаковать zip-архив с программой;

Папку PlotSPDS_for_nanoCAD поместить в любой каталог, куда у пользователя есть доступ;

Добавить файл PlotSPDS_22.package (для nanoCAD22,23, для nanoCAD20-> PlotSPDS_20.package) в автозагрузку, как показано на скриншоте.

image.png.563e58d242af4bc20cbd4996009ca360.png

Перезапустить nanoCAD.

На ленте появится вкладка “drzTools” с панелью Публикация СПДС.

image.png.a4cc658cfc9709551bdeec3afd0f0c81.png
В классическом интерфейсе появится новый пункт меню и панель инструментов
 image.png.90c6cf4a0f77ffdb2efef5b0f795f6e9.png
Eсли  панель инструментов не появилась вызвать ее можно по ПКМ на свободном месте панели инструментов
image.png.1e484e323fd2bfbda00c23535ea368c6.png
 Или через меню Вид
image.png.f0806a42231f28aaaa2a78cd72f327d8.png 
 

 

 

 

 

 

Спойлер
Кроме вызова через меню, панель или ленту, программу можно запустить из командной строки

СППУБЛИКАЦИЯ

spPublish

drz_PublishMC

 

откроется вот такое окошко

 

image.png.5b5ad44d3cb7b77c175c96e1b4801e47.png

 

 

 

Спойлер
Публикация в пакетном режиме:

на бумагу, (три различных устройства в зависимости от размера формата), поддержка преднастроенных шаблонов печати

в файл (PDF)

Выбор:

ручным выбором на чертеже,

с активного пространства,

открытого чертежа (чертежей),

из заданного каталога (каталогов)

Доступны опции:

поиск форматов в модели или листах

учитывать слои (прямым выбором или по маске)

Сортировка форматов:

обозначение->номер листа

по расположению в пространстве чертежа, учитывается порядок следования листов

Группировка форматов при печати в файл

Закладки (оглавление для файла PDF)

 

 

 

Спойлер
Для PDF настройки не требуются, просто выберите принтер PDF и стиль

==========

Для печати на бумагу

image.png.efc1a056517de190949caa15d9efe924.png

 

Откроются настройки шаблонов

image.png.6fd93a2be51af5269056e7d7de70dbd2.png

 

Можно добавить новый или удалить существующий шаблон

В размерах форматов задаем размер формата включительно, который может напечатать выбранный принтер в этой строке

Малые форматы предполагается принтер (только основные форматы, А4, А3, А2)

 

Средние и большие форматы это плоттер, печать на рулон (умеет дополнительные форматы А4х3, А3х5 и  т.д.) Формат определяется максимальной шириной рулона плоттера, для А1 это ~594, для А0~841

т.е. для настроек с рисунка выше:

на малый плоттер попадут А4, А3

на средний например А4х3, А3х3, А2, А2х3, А1

на большой А0, А1х3 и т.д.

Задаем стили печати

Сохраняем шаблон!!!!

Выход и можно печатать

 

Спойлер
При печати в PDF концепция такая:

Если задан "Путь вывода PDF":

напечатанные файлы будут по этому пути, если файл с таким именем уже есть, то добавляется суффикс (1), (2)....

Путь печати не задан:

Файл чертежа сохранен-> PDF будет рядом с файлом чертежа

Файл чертежа не сохранен->PDF будет в папке Мои документы

Несколько файлов сохраненных и не сохраненных->при сборке в один PDF -> файл PDF будет рядом с файлом первого формата (если первый формат не сохранен, в моих документах)

 

Пока вроде все, по мере поступления вопросов и замечаний статью буду дополнять.

Баги и пожелания эту тему.

Вышло очередное обновление 0.1.8464 от 05.03.2023  что нового?

Актуальная версия программы

Домашняя страница программы

 

 

 

 

multicad.net
 
plot
 
publish
Read more... 
    
 18 comments 1,279 views
doctorraz
Сшивка нескольких PDF или JPG в один PDF
By doctorraz, April 13, 2022


Разное
Смотрю тут как народ пытается поясниловки в нанокаде писать, опросники и прочее текстовое...

Имха все от того, что нужен один общий PDF для текста и графики.. простых решений навскидку вроде нет?

есть 

PDFUnisci

здесь https://github.com/Clouz/PDFUnisci/releases собранная утилита

тут исходники https://github.com/Clouz/PDFUnisci

алгоритм прост... собрать/разобрать PDF на листы или собрать PDF из JPG

 

Установить утилиту

PDFUnisci_Install.thumb.gif.135498421fa7a394a4cd07252feb8df9.gif

Собрать

PDFUnisci_Merge.thumb.gif.123cf6f7246b0c875c9a128c2a99d758.gif

 

Разбить

 

PDFUnisci_Split.thumb.gif.df876934e2ea6e7dde20a64c973cbe9f.gif

 

 

Уважаемый Clouz (Claudio Mola) в readme все подробно описал, но если кто не понял или не получилось.. спрашивайте

 

крошки
 
fre
Read more... 
    
 9 comments 650 views
doctorraz
Печать на встроенные принтеры PDF растром.
By doctorraz, January 10, 2022


Костылики
На этом и других форумах периодически возникает вопрос, как сделать растровый PDF средствами CAD, при том, что  nanoCAD выводит PDF вектором.

Собственно эта фича произрастает из древней нанобаги или оно просто так работает...

Если в любом месте листа вставить видовой экран (ВЭ), можно даже пустой, в область печати ему попадать совсем не обязательно, важно, что 

Спойлер
image.png.8c923be02bdf25c0ab0069bf0be5ccee.png

Для печати из пространства модели ставим аналогичный визуальный стиль, но там не торт((( все будет серенькое, при печати из листа эффект интереснее

Выбираем принтер "Встроенный PDF принтер", печатаем и вуаля, получаем растровый PDF. Правда побочный эффект значительное увеличение размера файла.

-----------------

Если вывести на "Печать в формате PDF" то получим удивительный эффект, наложение вектора на растр!!!

Спойлер
image.thumb.png.eb00cd36b7d90d68b3444406e13ea42b.png

 

Спойлер
image.thumb.png.def59326b6ad5bb8342621632362a535.png

Естественно размер файла будет еще больше.

----------------------

PS эксперименты проводил в nanoCAD22, но думаю в прошлых версиях все то же.

PPS поправить не прошу, если б могли давно исправили.

PDF растр.dwg

костылики
Read more... 
    
 11 comments 850 views
doctorraz
АвтоЗаполнялка. Часть 2
By doctorraz, August 31, 2021


Автоматизация
Сделал автозаполнялку , по результатам боевых стрельб внезапно выяснилось, что нана не умеет работать с полями нативных объектов.

Зато умеет вставлять поля из свойств документа (хотя возможно в следующей версии пофиксят и все будет наоборот)))

Возник вопрос, как запихнуть данные в  свойства документа....

Руками прям не вдохновляет

Спойлер
image.png.d238428f6d075708067bb818e58b3ebf.png

Второй вопрос откуда эти данные брать, решился просто, коль у нас на чертеже есть таблица, (автозаполнялка)  в которую мы занесли все сведения...

отчего бы данные не подтянуть из нее.

Принцип в кратце:

Хватаем конкретную таблицу на чертеже
Пробегаем по значениям именованных ячеек
Имя ячейки пишем как ключ в пользовательские свойства документа
Значением-свойством ключа будет содержимое ячейки
------------------------

Некритичные проверки исключений я не делал, кому надо вполне может дописать, как надо

Если изменить "комментарии"  ячеек, то соответственно в свойства документа запишутся другие ключи

Все ключи пишутся в пользовательские свойства документа, но при желании можно писать и в 

Спойлер
image.png.d1d023e4dfff1ade16c008af0f79a073.png

 

Под спойлером код, старался комментировал))

 

Спойлер

Dim ThisDrawing As Object
Sub docProp() 'заполнялка полей документа из таблицы (именованных ячеек)
    'без проверки исключений, чисто для общего понятия как
    Set objApp = GetObject(, "nanoCAD.Application") 'цепляемся к нане, или AutoCAD
    Set SPDS = CreateObject("McCOM2.Server") 'Получаем COM-сервер СПДС
    Set ThisDrawing = objApp.ActiveDocument 'хватаем активный документ
    Set ff = ThisDrawing
    TabName = "Заполнялка Таблица в таблицы" 'эту таблицу будем искать на чертеже
    Set FindTable = SPDS.Query("McCom2.SymTable", "Name=""" & TabName & """") _
            'ищем таблицу, можно изменить на свое
       If FindTable.Count > 0 Then 'если хоть одна таблица с таким именем найдена
        Set PropTable = FindTable(1).Properties 'хватаем первую из коллекции с таким именем (предполагается, что она одна)))
Dim varr
'<тут готовим путь для записи в таблицу (мне так надо)
        If ThisDrawing.FullName Like "*\*" Then 'НАНОКОСТЫЛЬ если файл сохранялся
            FulPatch = ThisDrawing.FullName
'<тут получаем имя файла без расширения
            varr = Split(ThisDrawing.Name, ".")
ReDim Preserve varr(UBound(varr) - 1)
            Filename = Join(varr, "")
        Else
            FulPatch = "ФАЙЛ НЕ СОХРАНЯЛСЯ!!"
            Filename = ThisDrawing.Name
        End If
Dim PropKey As String 'ключ для записи в свойства документа (коментарий ячейки)
Dim PropVal As String 'свойство ключа)) (содержимое ячейки)
On Error Resume Next 'страховочка вдруг такой ячейки нет((
        PropTable("Путь к файлу") = FulPatch 'пишем в ячейку полный путь
        PropTable("Имя файла") = Filename 'пишем в ячейку имя файла
On Error GoTo 0
    'тут в цикле заполняем свойства документа из именованных ячеек
        For Each namProp In PropTable.Names 'перебираем имена свойств
            Set PropProp = PropTable(namProp) 'получаем свойство по имени
            PropCategory = PropProp.Category
            If PropCategory = "Именованные ячейки" Then 'из свойств нам нужны только именованные ячейки
                PropKey = namProp 'коментарий ячейки будет ключ
                PropVal = PropProp.Value 'значение ячейки
                SetOrAddKey PropKey, PropVal 'идем писать в свойства
            End If
        Next
        res = "Значения именованных ячеек из " & "<" & TabName & ">" & _
                " записаны в свойства документа"
        ThisDrawing.SendCommand "(alert """ & res & """)" & vbCrLf
        SPDS.Message (res)
    Else
        MsgBox "Таблица: """ & TabName & """" & vbCrLf & _
                "не найдена на чертеже!", vbInformation, "docProp"
    End If
End Sub
    
Function SetOrAddKey(Key1 As String, val As String)
On Error Resume Next
    ThisDrawing.SummaryInfo.SetCustomByKey Key1, val 'НАНОКОСЯК если ключа нет в каде будет исключение, но нана создаст ключ)))
    If Err.Number <> 0 Then
        ThisDrawing.SummaryInfo.AddCustomInfo Key1, val
        Err.Number = 0
    End If
On Error GoTo 0
End Function
Sub main()
    docProp
End Sub
 

 

Сразу скажу из скрипта VBS внутри наны этот код работать не будет, хотя конечно заманчиво... (значения ключей и свойства должны быть String и никак иначе, а в скриптах типы данных я не умею )

Поэтому этот код запускается из Excel большой красной кнопкой.

В принципе, как дальнейшее развитие, этот код можно причесать, откомпилировать и запускать, хоть из командной строки нано, из меню или кнопкой на панели.

В аттаче шаблон чертежа и большая красная кнопка.

PS кода без багов не бывает, поэтому по мере... буду улучшать

Автозаполнялка через поля документа V2.dwg docProp.xlsm

таблицы
 
activex
 
docprop
 
vba
 
свойствадокумента
Read more... 
    
 2 comments 1,031 views
doctorraz
Как загрузить таблицу по ID в "голой" платформе?
By doctorraz, August 13, 2021


Костылики
Disclaimer сразу оговорюсь, способа узнать ID объекта в платформе пока не существует (по крайней мере мне неизвестно).
Хотя разработчики могли бы добавить такую возможность, например в утилиту конфигурации.  
Но подставить костылики можно.

Простой способ открыть в мастере объектов и посмотреть ID не рассматриваем (СПДС, Механик и прочие вертикалки работодатель не купил, а пробник выдохся))))

_________________________________________________________

 

Для чего нужен этот ID?

Для того, что бы иметь возможность в вставлять таблицы с кнопок, палитры инструментов или посредством lisp из командной строки. 

Вот такое выражение для кнопок, менюшек и инструментов:

^C^C_stdselected <ID>
 

для lisp (кстати лисп выражения прекрасно работают в менюшках и инструментах)

(defun C:ИмяКоманды ()
  (command "spStdSelected" "<ID>")
  (princ)
) 
Что такое этот ID?

Уникальный идентификатор объекта в базе данных (БД), именно по нему программа узнает какой объект вставить на чертеж.

Что мы знаем о таблицах и их ID?

У каждой таблицы в БД есть свой ID:

Если перемещать таблицу внутри базы по "каталогам", ID не изменяется;
Если переименовать таблицу , ID не изменяется;
Если утилитой конфигурации экспортировать таблицу, у экспортированной ID будет такой же;
Если импортировать таблицу в базу, у импортированной будет тот же ID, но
если в базе таблица с таким ID уже есть она будет перезаписана импортируемой (независимо от имени);
Если в в каталоге базы есть таблица с другим ID, но таким же именем, то при импорте таблица перезаписана не будет ( в этом каталоге будут две одноименные таблицы);
После вставки на чертеж ID у таблицы на чертеже нет;
Если после редактирования на чертеже сохранить в "каталог" базы одноименную таблицу,  ID таблицы которая была в базе не изменится.
Что дает нам это знание?

Можно сделать экспорт из БД интересующих объектов и попросить имеющих СПДС импортировать их к себе, посмотреть ID,
вариант рабочий, но далеко не каждый имеет БД для тестов и поэтому вряд ли будет импортировать себе неизвестно, что с риском перезаписать свои объекты;
Можно модифицировать и перезаписать стандартные таблицы из БД (их ID можно посмотреть в инструментах)
как по мне так себе идея  модифицировать стандартные объекты, при обновлении базы могут перезаписаться опять стандартными;
Можно импортировать в свою БД таблицы с заранее известными ID и в дальнейшем работать с ними
Суть идеи...

Загружаем в свою базу таблицы отсюда  
в архиве *.mcd таблицы пустышки, имя таблицы, ее ID;
Импортируем таблицы в свою БД в любое место;
Запоминаем имена-ID таблиц либо сразу привязываем их на кнопки и в инструменты;
В утилите конфигурации переименовываем таблицы, как требуется, там же в утилите можно переместить таблицы в нужные каталоги.
Свои настроенные таблицы из БД вставляем на чертеж (либо настраиваем непосредственно на чертеже)
Сохраняем таблицы с чертежа в БД 
!!!Важно в тот же каталог и под тем же именем, где лежит таблица пустышка (с заранее известным ID)
Настроенная таблица перезапишет ту, что в базе, но ID не измениться;
Профит, пользуемся и :prey: разработчикам, что бы они добавили возможность посмотреть ID  в "голую" платформу
---------------

PS Если вдруг кто не в курсе

Спойлер
image.png.5210dcae15fde4d1c66586939616e71b.png

 

Спойлер
image.thumb.png.29242fbe4d57a5a3d35aa6df63d384fa.png

Спойлер
image.png.f228d66e60294bade5e679745996febd.png

Никак не связаны и не обязательно должны совпадать, 

крошки
Read more... 
    
 0 comments 410 views
doctorraz
Attsync. Альтернатива
By doctorraz, August 10, 2021


Автоматизация
  Ждать пока nanoDev выгребет все баги мне некогда, работать надо сейчас, поэтому...

Под свои потребности сделал сборочку, на основе кода Андрея Бушмана (с небольшими изменениями).

взять сборочку можно тут: https://disk.yandex.ru/d/87lVPPumz3FPzA

В архиве две сборки под Autocad 2018-2021 и nanoCad 21. Также в архиве простенький тестовый dwg пример.

Для вызова доступны две команды:

от Андрея Бушмана drz-MySynch
что делает:

синхронизирует атрибуты блоков с их описанием, но при этом не смещает, не вращает атрибут в положение по умолчанию. т.е. после синхронизации все существующие в описании атрибуты по идее остаются на своих местах;
не изменяет состояние видимости вхождения блока;
удаленные в описании блока атрибуты из вхождения удаляются, добавленные в описание блока добавляются во вхождения (если есть значение по умолчанию, то с этими значениями)
   2. от Gilles Chanteau drz-MySynchHard

 что делает:

то что должен был делать Attsync в nanoCad 21, только по нормальному (без удаления значений атрибутов и видит атрибуты в измененных дин блоках)
!!!! Важно:

 drz-MySynch работает только в nanoCad  21, в nanoCad  20.х некоторые .NET методы не реализованы (либо я не разобрался, как((();
drz-MySynchHard в nanoCad  20 обрабатывает только статические блоки, в nanoCad  21 обрабатывает все;
Тестировалось на nanoCad х64 (теоретически должно и на х86 работать, если надо пересоберу без проблем);
На автокад не тестировалось, но по опыту предыдущих стрельб должно работать на АК2018-2021
Короче кому интересно скачивайте пробуйте.

net
Read more... 
    
 0 comments 375 views
doctorraz
NET Переместить маскировку в блоке на задний план
By doctorraz, August 5, 2021


Автоматизация
В nano  20.х добавили функциональную панель "Инструменты" (в Autocad называлось палитра)

Сама по себе неплохая штука и порой весьма удобная.. 

Но местами весьма глючная, а глючная в плане того, что при вставке блоков путает порядок прорисовки и поднимает маскировку этих блоков на передний план.

Спойлер
image.png.7272304427ec9180111ece44bccd437b.png

В nano21 эту багу исправили.

В принципе казалось бы, в чем проблема..

открой блок на редактирование и утопи маскировку, ан нет, nana20 не умеет редактировать динамические блоки.

Да и статические после вставки нового блока с функциональной панели "Инструментов" каждый раз править, то еще удовольствие(((

Но решение достаточно простое

Спойлер

#if NC
using Teigha.DatabaseServices;
using Teigha.Runtime;
using HostMgd.ApplicationServices;
using HostMgd.EditorInput;

#else
using Autodesk.AutoCAD.ApplicationServices;
using Autodesk.AutoCAD.DatabaseServices;
using Autodesk.AutoCAD.EditorInput;
using Autodesk.AutoCAD.Runtime;
#endif
namespace drz
{
    public class Utils : IExtensionApplication

    {
        [CommandMethod("drz-WipBot", CommandFlags.Modal)]
        public void WipeoutToBotton()
        /*Топит маскировку внутри блоков
         */
        {
            Document doc = Application.DocumentManager.MdiActiveDocument;
            Database db = doc.Database;
            Editor ed = doc.Editor;
            int count = 0;
            //using (Transaction tr = db.TransactionManager.StartOpenCloseTransaction())//вот нельзя тут так делать, только для UpgradeOpen(), DowngradeOpen();
//иначе Автокад валится, нане пофих
            using (Transaction tr = db.TransactionManager.StartTransaction())  
            {
                BlockTable bt = (BlockTable)tr.GetObject(db.BlockTableId, OpenMode.ForRead);
                foreach (ObjectId btrId in bt)
                {
                    BlockTableRecord btr = (BlockTableRecord)tr.GetObject(btrId, OpenMode.ForRead);
                    if (!btr.IsFromExternalReference && !btr.IsDependent && !btr.IsLayout)// not xref and not xref|block and not Layout
                    {
                        foreach (ObjectId id in btr)
                        {
                            Entity ent = tr.GetObject(id, OpenMode.ForRead) as Entity;
                            if (ent != null)
                            {
                                Wipeout wpt = ent as Wipeout;
                                if (wpt != null)//если маскировка
                                {
                                    // получаем таблицу порядка отрисовки блока
                                    DrawOrderTable drawOrder =
                                                         tr.GetObject(btr.DrawOrderTableId,
                                                        OpenMode.ForWrite) as DrawOrderTable;
                                    ObjectIdCollection ids = new ObjectIdCollection();
                                    ids.Add(wpt.ObjectId);
                                    drawOrder.MoveToBottom(ids);//топим маскировку
                                    count++;
                                }
                            }
                        }
                    }
                }
                tr.Commit();
            }
            ed.Regen();
            ed.WriteMessage(
                "Move to bottom in blocks " + count + " wipeout"
                );
        }
        //-----------------------------
        public void Initialize()
        {
            Editor ed = Application.DocumentManager.MdiActiveDocument.Editor;
            ed.WriteMessage("\n\"drz\" загружен");
            ed.WriteMessage("\nВызов drz-WipBot");
        }
        public void Terminate()
        {
        }
    }
}
 

Проходит по всем описаниям блоков находит в них маскировки и топит их на дно.

вызов из командной строки drz-WipBot

Тестировался в nano20.1-21, Autocad2018-2021 (естественно в каждый CAD) надо загружать свою сборку (NETLOAD или APPLOAD)

Спойлер
image.png.7ac6ed6a44526d85dd51caf806d556f6.png

Форум не позволяет загружать dll и архивы, поэтому ссылка на сборку и там же пример блоков которые режут линию под собой

блок
 
wipeout
 
net
 
c#
Read more... 
    
 0 comments 964 views
doctorraz
Заполнялка пользовательских свойств в DWG
By doctorraz, June 18, 2021


Автоматизация
В рамках самообучения VB.NET решил портировать VBA из Автозаполнялка. Часть 2

Естественно, я сильно не заморачивался, просто добавил нужные функции для себя, ну и прикрутил интерфейс для других))

Для чего это нужно можете прочитать выше по ссылке...

Возможности утилиты:

Работает с нанокад и автокад+СПДС
Удаление всех пользовательских свойств документа DWG
Добавляет пользовательские свойства в активный документ из таблиц nanoCad (именованные ячейки)
прямым выбором таблиц на чертеже
сохраненное имя таблицы из настроек
режим ком строки (без интерфейса) ключи:
без ключа-поведение определяется настройкой утилиты, возможны опции:
Открыть настройки (интерфейс)
Записать в свойства документа данные из имени таблицы сохраненной в настройках
Выбрать таблицу для записи в свойства документа на чертеже
1-Записать в свойства документа данные из имени таблицы сохраненной в настройках
2-Выбрать таблицу для записи в свойства документа на чертеже
любой другой ключ-Интерфейс, откроется окно настроек
Обновление утилиты онлайн (в смысле при наличии интернета, сама проверит обновление и попросит обновиться)
=====================

В принципе функционал можно  наращивать до бесконечности (если кто-то проявит интерес)...собирал для себя, то что необходимо мне)))

upd Накрутил там еще шашечек))) по мелочи и продолжаю пилить

Спойлер
image.png.6ac2f36c414224b52b044508985377ba.png

Спойлер
image.png.85137f1639a2cbf8695776ce67157751.png

 

image.png.aece71222de3bef4337f5d0b958c92a5.png

 

 

 

Как всегда конструктивная и не очень критика, а также замечания и пожелания только приветствуются

 Заполнялка Таблица в таблицы.dwg


docProp

автоматизация
 
крошки
Read more... 
    
 0 comments 754 views
doctorraz
SPREFSHOW. Не по правилам
By doctorraz, May 26, 2021


Разное
На днях колеги подогнали файл со схемами предприятия

Спойлер
image.thumb.png.d5ca87365d58717b344e4251b916f75f.png

Ну а чо они так видят, им удобно и они в этом чертеже ориентируются вполне комфортно, в отличие от меня.

Вблизи схемы как схемы

Спойлер
image.png.f1892224685a73e1967b980200c68463.png

 

Спойлер
image.png.92c36affa2cf64d370d4eb951b4d61b4.png

Среди этой красоты мне нужно было найти определенную подстанцию ТП-8/7 и фидера откуда она питается

 

Спойлер
image.png.60d838cd59af854898e29137f709ce1c.png

Долог и неинформативен

Благо коллеги в кадах не сильно искушены и все надписи были сделаны просто текстом

И я подумал ведь есть служебная команда SPREFSHOW которая укажет мне путь)))

Добавил таблицу на чертеж

Добавил раздел  отчета

Спойлер
image.png.0b8c0959d042f105cb49a15c7628576c.png

если кому надо искать в мтекстах или других объектах, то добавляется по аналогии...

Для того что бы показывало объекты по SPREFSHOW, должно быть взято хотя бы одно свойство с объекта, ничего оригинальнее чем  взять =Object.Text я придумать не смог

Больше свойств брать не стоит, лишние связи будут мешать, загромождать... короче не надо

Ну и для перфекционизму объединил первый столбец и поставил на него счетчик

Спойлер
image.png.f91b5ca8fba591ca819a7c1c79375a4a.png

выходим из редактора таблиц

выделяем нашу табличку и в ком строке вводим вожделенное SPREFSHOW

Спойлер
image.thumb.png.04bd57f69fdaced8bc19609907725104.png

линии связей укажут искомое)))

---------------

ЗЫ мне реально лениво переключаться на инглиш раскладку, а потом еще и набирать такое длинное слово

можно добавить через НПИ в команды, менюшки и панельки..... но тогда нано,  все мои красиво расположенные  функциональные и не очень панельки смешает в кучу..

я работаю в основном из ком строки..

поэтому добавил в подгружаемый lisp команду

(defun C:спсс ();;Показать зависимости
	(command "SPREFSHOW" ) 
	(princ)
) 
благо что lisp команды можно добавлять, изменять не перезагружая нану (достаточно перезагрузить лисп))))..

в отличие от добавления команд через интуитивно понятный и чертовски удобный НПИ(((который после рестарта нано нарушит гармонию панелек настроенных мной, на строгий порядок определенный суровым разработчиком)))

-->
